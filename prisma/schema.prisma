generator client {
  provider = "prisma-client"
  output   = "../generated/prisma"
}

datasource db {
  provider = "postgresql"
}

model User {
  id      String @id @default(uuid()) @db.Uuid
  
  auth0Id String @unique @map("auth0_id") 

  name  String
  email String @unique

  applications Application[]

  @@map("users")
}

model Application {
  id     String @id @default(uuid()) @db.Uuid
  userId String @map("user_id") @db.Uuid

  title       String
  companyName String  @map("company_name")
  position    String?

  salary     Float?
  salaryType String? // asked / offered
  currency   String?

  workModel String? @map("work_model") // remote / hybrid / onsite
  regime    String? // clt / pj / other

  description String?
  appliedAt   DateTime? @map("applied_at")

  status String // applied / reply / interview / offer / rejected / accepted
  columnIndex Int @map("column_index")

  user             User              @relation(fields: [userId], references: [id], onDelete: Cascade)
  applicationLinks ApplicationLink[] 
  deadlines Deadline[]

  @@map("applications")
}

model ApplicationLink {
  id            String @id @default(uuid()) @db.Uuid
  applicationId String @db.Uuid

  label String?
  url   String

  application Application @relation(fields: [applicationId], references: [id], onDelete: Cascade)

  @@map("application_links")
}

model Deadline {
  id String @id @default(uuid()) @db.Uuid
  applicationId String @db.Uuid
  
  label String
  date DateTime

  application Application @relation(fields: [applicationId], references: [id], onDelete: Cascade)

  @@map("deadlines")
}